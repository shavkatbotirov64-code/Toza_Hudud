üîç BACKEND HOLATI - TO'LIQ TEKSHIRUV
=====================================

‚úÖ ISHLAYOTGAN KOMPONENTLAR:
----------------------------

1. Vehicle API:
   - GET /vehicles - Barcha mashinalar
   - POST /vehicles - Yangi mashina yaratish
   - PUT /vehicles/:id - Mashina yangilash
   - DELETE /vehicles/:id - Mashina o'chirish
   - PUT /vehicles/:vehicleId/location - Pozitsiya yangilash
   - PUT /vehicles/:vehicleId/state - Holat yangilash

2. WebSocket Gateway:
   - vehiclePositionUpdate - Real-time pozitsiya
   - vehicleStateUpdate - Real-time holat
   - Barcha clientlarga broadcast

3. Cleaning API:
   - POST /cleanings - Tozalash yozuvi yaratish
   - Avtomatik bin fillLevel'ni 15 ga o'zgartiradi
   - Activity log yaratadi
   - Marshrut ma'lumotlarini saqlaydi (routePath, startTime, endTime, averageSpeed)

4. Bins API:
   - GET /bins - Barcha qutilar
   - PUT /bins/:id/clean - Qutini tozalash (fillLevel = 15)
   - WebSocket orqali binUpdate broadcast

5. Sensors API:
   - POST /sensors/data - ESP32 dan ma'lumot qabul qilish
   - WebSocket orqali sensorData broadcast
   - Bin fillLevel avtomatik yangilanadi

6. Statistics API:
   - GET /statistics/overview - Umumiy statistika
   - GET /statistics/vehicles - Mashinalar statistikasi
   - GET /statistics/bins - Qutilar statistikasi

7. Activities API:
   - GET /activities - Faoliyatlar tarixi
   - Avtomatik logging (bin cleaned, vehicle dispatched, etc.)

‚ùå MUAMMOLAR:
-------------

1. Vehicle yaratishda default status:
   - Kod to'g'ri: status: data.status || 'moving'
   - Lekin backend hali eski versiyada (deploy tugamagan)
   - Hozirgi mashinalar: status: 'idle'

2. Eski mashinalar:
   - VEH-001: status: idle, isPatrolling: false
   - VEH-002: status: idle, isPatrolling: true
   - Frontend'da majburiy 'moving' qilingan

üîß YECHIM:
----------

1. Backend deploy tugashini kutish (3-5 daqiqa)
2. Mashinalarni qayta yaratish:
   cd backend
   node reset-everything.js

3. Frontend'da localStorage tozalash:
   localStorage.clear(); location.reload(true);

üìä BACKEND DEPLOY HOLATI:
-------------------------

Deploy qilingan: 2026-02-18 23:53
Build URL: https://railway.com/project/.../service/.../id=fcc5568b-da2a-48d0-bcc9-541aa7232947

Kutilayotgan o'zgarishlar:
- Vehicle yaratishda status: 'moving' (default)
- isMoving: true (default)
- isPatrolling: true (default)

‚úÖ BACKEND UMUMIY HOLATI:
-------------------------

Backend to'liq ishlayapti va barcha kerakli funksiyalar mavjud:
- Real-time WebSocket
- Vehicle tracking
- Bin monitoring
- Cleaning management
- Statistics
- Activity logging

Yagona muammo: Yangi kod hali deploy bo'lmagan.
Deploy tugagandan keyin barcha muammolar hal bo'ladi.

üìù KEYINGI QADAMLAR:
-------------------

1. Backend deploy tugashini kuzatish:
   cd backend
   railway logs --tail 50

2. Deploy tugaganda mashinalarni tekshirish:
   node check-vehicles.js
   
   Kutilayotgan natija:
   - Status: moving
   - isPatrolling: true

3. Agar hali ham idle bo'lsa, qayta yaratish:
   node reset-everything.js

4. Frontend'da localStorage tozalash va test qilish
